<div class="page-stack">
  <header class="page-header">
    <h1>Benchmark Runs</h1>
    <p>
      Create a run for each adapter and track scheduling and completion times.
    </p>
  </header>

  <section class="card-grid">
    <div class="card bg-base-100 shadow">
      <div class="card-body">
        <h2 class="card-title">SolidQueue</h2>
        <div class="button-grid">
          <%= link_to "SolidQueue admin", "/solid_queue", class: "btn btn-outline btn-sm" %>
        </div>
        <div class="button-grid">
          <%= button_to "1k jobs", benchmark_runs_path,
            params: { benchmark_run: { gem: "solid_queue", jobs_count: 1000 } },
            form_class: "button-grid-item", class: "btn btn-primary btn-sm" %>
          <%= button_to "10k jobs", benchmark_runs_path,
            params: { benchmark_run: { gem: "solid_queue", jobs_count: 10000 } },
            form_class: "button-grid-item", class: "btn btn-primary btn-sm" %>
          <%= button_to "100k jobs", benchmark_runs_path,
            params: { benchmark_run: { gem: "solid_queue", jobs_count: 100000 } },
            form_class: "button-grid-item", class: "btn btn-primary btn-sm" %>
          <%= button_to "1M jobs", benchmark_runs_path,
            params: { benchmark_run: { gem: "solid_queue", jobs_count: 1000000 } },
            form_class: "button-grid-item", class: "btn btn-primary btn-sm" %>
        </div>
      </div>
    </div>

    <div class="card bg-base-100 shadow">
      <div class="card-body">
        <h2 class="card-title">GoodJob</h2>
        <div class="button-grid">
          <%= link_to "GoodJob admin", "/good_job", class: "btn btn-outline btn-sm" %>
        </div>
        <div class="button-grid">
          <%= button_to "1k jobs", benchmark_runs_path,
            params: { benchmark_run: { gem: "good_job", jobs_count: 1000 } },
            form_class: "button-grid-item", class: "btn btn-secondary btn-sm" %>
          <%= button_to "10k jobs", benchmark_runs_path,
            params: { benchmark_run: { gem: "good_job", jobs_count: 10000 } },
            form_class: "button-grid-item", class: "btn btn-secondary btn-sm" %>
          <%= button_to "100k jobs", benchmark_runs_path,
            params: { benchmark_run: { gem: "good_job", jobs_count: 100000 } },
            form_class: "button-grid-item", class: "btn btn-secondary btn-sm" %>
          <%= button_to "1M jobs", benchmark_runs_path,
            params: { benchmark_run: { gem: "good_job", jobs_count: 1000000 } },
            form_class: "button-grid-item", class: "btn btn-secondary btn-sm" %>
        </div>
      </div>
    </div>
  </section>

  <section class="card-grid">
    <div class="card bg-base-100 shadow">
      <div class="card-body">
        <h2 class="card-title">SolidQueue Runs</h2>
        <% if @solid_queue_runs.any? %>
          <div class="table-wrap">
            <table class="table table-zebra table-sm table-compact">
              <thead>
                <tr>
                  <th>Jobs</th>
                  <th>Created</th>
                  <th>Scheduling</th>
                  <th>Run</th>
                  <th>Actions</th>
                </tr>
              </thead>
              <tbody>
                <% @solid_queue_runs.each do |run| %>
                  <tr>
                    <td><%= run.jobs_count %></td>
                    <td><%= run.created_at %></td>
                    <td>
                      <%= duration_or_pending(run.scheduling_duration) %>
                    </td>
                    <td>
                      <%= duration_or_pending(run.run_duration) %>
                    </td>
                    <td>
                      <%= button_to "Delete",
                        benchmark_run_path(run),
                        method: :delete,
                        data: { turbo_confirm: "Delete this run?" },
                        class: "btn btn-ghost btn-xs" %>
                    </td>
                  </tr>
                <% end %>
              </tbody>
            </table>
          </div>
        <% else %>
          <div class="alert alert-info">No SolidQueue runs yet.</div>
        <% end %>
      </div>
    </div>

    <div class="card bg-base-100 shadow">
      <div class="card-body">
        <h2 class="card-title">GoodJob Runs</h2>
        <% if @good_job_runs.any? %>
          <div class="table-wrap">
            <table class="table table-zebra table-sm table-compact">
              <thead>
                <tr>
                  <th>Jobs</th>
                  <th>Created</th>
                  <th>Scheduling</th>
                  <th>Run</th>
                  <th>Actions</th>
                </tr>
              </thead>
              <tbody>
                <% @good_job_runs.each do |run| %>
                  <tr>
                    <td><%= run.jobs_count %></td>
                    <td><%= run.created_at %></td>
                    <td>
                      <%= duration_or_pending(run.scheduling_duration) %>
                    </td>
                    <td>
                      <%= duration_or_pending(run.run_duration) %>
                    </td>
                    <td>
                      <%= button_to "Delete",
                        benchmark_run_path(run),
                        method: :delete,
                        data: { turbo_confirm: "Delete this run?" },
                        class: "btn btn-ghost btn-xs" %>
                    </td>
                  </tr>
                <% end %>
              </tbody>
            </table>
          </div>
        <% else %>
          <div class="alert alert-info">No GoodJob runs yet.</div>
        <% end %>
      </div>
    </div>
  </section>
</div>
